---
import { Send } from 'lucide-react';
--- 

<section id="contact" class="py-20">
  <div class="container mx-auto px-4">
    <h2 class="text-4xl font-bold text-center mb-12">Contact Us</h2>
    <div class="grid md:grid-cols-2 gap-24 items-start">
      
      <!-- Contact Form -->
      <form id="contact-form">
        <div class="grid md:grid-cols-2 gap-4 mb-4">
          <input type="text" name="name" placeholder="Your Name" class="bg-white p-4 rounded-lg w-full shadow-lg" required minlength="2">
          <input type="email" name="email" placeholder="Your Email" class="bg-white p-4 rounded-lg w-full shadow-lg" required>
        </div>
        <textarea name="message" placeholder="Your Message" class="bg-white p-4 rounded-lg w-full mb-4 shadow-lg" rows="6" required minlength="10"></textarea>
        
        <!-- Honeypot Field for Spam Protection -->
        <div style="position: absolute; left: -5000px;" aria-hidden="true">
          <input type="text" name="honeypot" tabindex="-1" autocomplete="off">
        </div>

        <div class="flex justify-center">
          <button type="submit" id="submit-button" class="bg-accent-green text-white font-bold py-3 px-8 rounded-full hover:bg-accent-green/80 transition-colors flex items-center">
            Send Message <Send className="ml-2" />
          </button>
        </div>
        <p id="status-message" class="text-center mt-4"></p>
      </form>

      <!-- Address and Social Media -->
      <div class="text-center">
        <div>
          <h3 class="text-2xl font-bold mb-4">Head Office</h3>
          <p>P-20, Ground Floor, South Extention - II</p>
          <p>New Delhi - 110049</p>
          <p class="mt-4"><strong>Tel.:</strong> 011-40581276 (10 AM - 06 PM)</p>
          <p><strong>Mob:</strong> +91-96500-67855</p>
          <p><strong>Email:</strong> mtdelhi15@gmail.com</p>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  const form = document.getElementById('contact-form') as HTMLFormElement;
  const submitButton = document.getElementById('submit-button');
  const statusMessage = document.getElementById('status-message');
  const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwUQzLeQ6iqZGG6ST2bdJfaCtIO4MukagYFmBlqQJUXKrsCFoVcmiQ06ImwA8ESwAwKGw/exec'; // Still needs your URL

  form.addEventListener('submit', async (e) => {
    e.preventDefault();

    if (submitButton) submitButton.setAttribute('disabled', 'true');
    if (statusMessage) {
      statusMessage.textContent = 'Sending...';
      statusMessage.style.color = '#5B21B6'; // primary-purple
    }

    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());

    // --- Client-side validation --- 
    if (data.honeypot) { // Bot check
      console.log('Honeypot field filled. Submission rejected.');
      return; // Silently fail
    }
    if (data.name.toString().trim().length < 2) {
        if (statusMessage) statusMessage.textContent = 'Please enter a valid name.';
        if (submitButton) submitButton.removeAttribute('disabled');
        return;
    }
    if (data.message.toString().trim().length < 10) {
        if (statusMessage) statusMessage.textContent = 'Your message is too short.';
        if (submitButton) submitButton.removeAttribute('disabled');
        return;
    }
    // --- End validation ---

    try {
      const response = await fetch(SCRIPT_URL, {
        method: 'POST',
        headers: {
          'Content-Type': 'text/plain;charset=utf-8',
        },
        body: JSON.stringify(data),
        mode: 'cors',
      });

      const result = await response.json();

      if (result.result === 'success') {
        if (statusMessage) {
          statusMessage.textContent = 'Thank you! Your message has been sent.';
          statusMessage.style.color = '#16A34A'; // accent-green
        }
        form.reset();
      } else {
        throw new Error(result.error || 'An unknown error occurred.');
      }

    } catch (error) {
      if (statusMessage) {
        statusMessage.textContent = 'An error occurred. Please try again later.';
        statusMessage.style.color = '#DC2626'; // Red
        console.error('Form Submission Error:', error);
      }
    } finally {
      if (submitButton) submitButton.removeAttribute('disabled');
    }
  });
</script>
